<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —É–∫—Ä–∞–∏–Ω—Å–∫–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .loading {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .translation-test {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            margin: 4px 0;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .key {
            font-family: monospace;
            color: #6c757d;
        }
        .value {
            font-weight: bold;
        }
        .ukrainian {
            color: #28a745;
        }
        .russian {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <h1>üá∫üá¶ –¢–µ—Å—Ç —É–∫—Ä–∞–∏–Ω—Å–∫–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h1>
    
    <div class="test-section">
        <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h2>
        <div id="fileTest" class="test-result loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <button onclick="testTranslationFile()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –ø–µ—Ä–µ–≤–æ–¥–æ–≤</button>
    </div>

    <div class="test-section">
        <h2>–¢–µ—Å—Ç API –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h2>
        <div id="apiTest" class="test-result loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <button onclick="testApiTranslations()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –ø–µ—Ä–µ–≤–æ–¥—ã</button>
    </div>

    <div class="test-section">
        <h2>–¢–µ—Å—Ç –∫–ª—é—á–µ–≤—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤</h2>
        <div id="keyTranslations"></div>
        <button onclick="testKeyTranslations()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã</button>
    </div>

    <div class="test-section">
        <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞</h2>
        <div>
            <p><strong>–Ø–∑—ã–∫ –±—Ä–∞—É–∑–µ—Ä–∞:</strong> <span id="browserLang"></span></p>
            <p><strong>–¢–µ–∫—É—â–∏–π URL:</strong> <span id="currentUrl"></span></p>
            <p><strong>localStorage —è–∑—ã–∫:</strong> <span id="localStorageLang"></span></p>
        </div>
    </div>

    <script>
        // –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
        const testKeys = [
            { key: 'admin.servicePoints.title', expected: '–¢–æ—á–∫–∏ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è' },
            { key: 'common.save', expected: '–ó–±–µ—Ä–µ–≥—Ç–∏' },
            { key: 'common.cancel', expected: '–°–∫–∞—Å—É–≤–∞—Ç–∏' },
            { key: 'filters.region', expected: '–†–µ–≥—ñ–æ–Ω' },
            { key: 'filters.city', expected: '–ú—ñ—Å—Ç–æ' },
            { key: 'admin.servicePoints.searchPlaceholder', expected: '–ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é –∞–±–æ –∞–¥—Ä–µ—Å–æ—é...' },
            { key: 'tables.columns.servicePoint', expected: '–°–µ—Ä–≤—ñ—Å–Ω–∞ —Ç–æ—á–∫–∞' },
            { key: 'tables.columns.partner', expected: '–ü–∞—Ä—Ç–Ω–µ—Ä' },
            { key: 'tables.columns.workingHours', expected: '–†–æ–±–æ—á—ñ –≥–æ–¥–∏–Ω–∏' }
        ];

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞
        document.getElementById('browserLang').textContent = navigator.language || '–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
        document.getElementById('currentUrl').textContent = window.location.href;
        document.getElementById('localStorageLang').textContent = localStorage.getItem('language') || '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';

        async function testTranslationFile() {
            const testDiv = document.getElementById('fileTest');
            testDiv.className = 'test-result loading';
            testDiv.textContent = '–ü—Ä–æ–≤–µ—Ä—è—é —Ñ–∞–π–ª –ø–µ—Ä–µ–≤–æ–¥–æ–≤...';

            try {
                const response = await fetch('/src/i18n/locales/uk.json');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const translations = await response.json();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–µ–∫—Ü–∏–π
                const sections = ['common', 'admin', 'filters', 'tables'];
                const missingSections = sections.filter(section => !translations[section]);
                
                if (missingSections.length > 0) {
                    testDiv.className = 'test-result error';
                    testDiv.textContent = `‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Å–µ–∫—Ü–∏–∏: ${missingSections.join(', ')}`;
                    return;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä—É—Å—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
                const jsonString = JSON.stringify(translations);
                const russianPatterns = [
                    '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏',
                    '–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é',
                    '–Ω–µ –Ω–∞–π–¥–µ–Ω—ã',
                    '–°–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É',
                    '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫—É'
                ];
                
                const foundRussian = russianPatterns.filter(pattern => jsonString.includes(pattern));
                
                if (foundRussian.length > 0) {
                    testDiv.className = 'test-result error';
                    testDiv.innerHTML = `‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã —Ä—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã:<br>${foundRussian.map(text => `‚Ä¢ ${text}`).join('<br>')}`;
                    return;
                }

                testDiv.className = 'test-result success';
                testDiv.textContent = '‚úÖ –§–∞–π–ª –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ, —Ä—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                
            } catch (error) {
                testDiv.className = 'test-result error';
                testDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`;
            }
        }

        async function testApiTranslations() {
            const testDiv = document.getElementById('apiTest');
            testDiv.className = 'test-result loading';
            testDiv.textContent = '–ü—Ä–æ–≤–µ—Ä—è—é API –ø–µ—Ä–µ–≤–æ–¥—ã...';

            try {
                // –°–∏–º—É–ª–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å —É–∫—Ä–∞–∏–Ω—Å–∫–∏–º —è–∑—ã–∫–æ–º
                const response = await fetch('http://localhost:3008/admin/service-points', {
                    headers: {
                        'Accept-Language': 'uk',
                        'Content-Type': 'text/html'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const html = await response.text();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —É–∫—Ä–∞–∏–Ω—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤ –≤ HTML
                const ukrainianTexts = [
                    '–¢–æ—á–∫–∏ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è',
                    '–†–µ–≥—ñ–æ–Ω',
                    '–ú—ñ—Å—Ç–æ',
                    '–ü–∞—Ä—Ç–Ω–µ—Ä'
                ];
                
                const foundTexts = ukrainianTexts.filter(text => html.includes(text));
                
                if (foundTexts.length === ukrainianTexts.length) {
                    testDiv.className = 'test-result success';
                    testDiv.textContent = '‚úÖ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫—Ä–∞–∏–Ω—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã';
                } else {
                    testDiv.className = 'test-result error';
                    testDiv.textContent = `‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ —Ç–æ–ª—å–∫–æ ${foundTexts.length} –∏–∑ ${ukrainianTexts.length} —É–∫—Ä–∞–∏–Ω—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤`;
                }
                
            } catch (error) {
                testDiv.className = 'test-result error';
                testDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`;
            }
        }

        async function testKeyTranslations() {
            const container = document.getElementById('keyTranslations');
            container.innerHTML = '<div class="test-result loading">–ü—Ä–æ–≤–µ—Ä—è—é –∫–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã...</div>';

            try {
                const response = await fetch('/src/i18n/locales/uk.json');
                const translations = await response.json();
                
                let html = '';
                let successCount = 0;
                
                testKeys.forEach(({ key, expected }) => {
                    const keys = key.split('.');
                    let value = translations;
                    
                    try {
                        for (const k of keys) {
                            value = value[k];
                        }
                        
                        const isCorrect = value === expected;
                        const className = isCorrect ? 'ukrainian' : 'russian';
                        if (isCorrect) successCount++;
                        
                        html += `
                            <div class="translation-test">
                                <span class="key">${key}</span>
                                <span class="value ${className}">${value || '–ù–ï –ù–ê–ô–î–ï–ù–û'}</span>
                                <span>${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                            </div>
                        `;
                    } catch (e) {
                        html += `
                            <div class="translation-test">
                                <span class="key">${key}</span>
                                <span class="value russian">–ù–ï –ù–ê–ô–î–ï–ù–û</span>
                                <span>‚ùå</span>
                            </div>
                        `;
                    }
                });
                
                const resultClass = successCount === testKeys.length ? 'success' : 'error';
                const resultText = `${successCount}/${testKeys.length} –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã`;
                
                container.innerHTML = `
                    <div class="test-result ${resultClass}">${resultText}</div>
                    ${html}
                `;
                
            } catch (error) {
                container.innerHTML = `<div class="test-result error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            testTranslationFile();
            testKeyTranslations();
        });
    </script>
</body>
</html> 