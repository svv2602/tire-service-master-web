<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .api-result {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .language-switcher {
            margin-bottom: 20px;
        }
        .language-switcher button {
            background: #6c757d;
        }
        .language-switcher button.active {
            background: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ –¢–µ—Å—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h1>
        <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /client/booking</p>
        
        <div class="language-switcher">
            <strong>–¢–µ–∫—É—â–∏–π —è–∑—ã–∫:</strong>
            <button id="lang-ru" onclick="setLanguage('ru')">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
            <button id="lang-uk" onclick="setLanguage('uk')">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</button>
        </div>
        
        <div class="test-section">
            <h3>üìç –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ –≥–æ—Ä–æ–¥—É</h3>
            <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º API endpoint: <code>/api/v1/service_categories/by_city_id/{cityId}?locale={locale}</code></p>
            <button onclick="testCategoriesAPI()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API</button>
            <div id="api-result" class="api-result"></div>
        </div>
        
        <div class="test-section">
            <h3>üåê –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞</h3>
            <p>–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:</p>
            <button onclick="openBookingPage()">–û—Ç–∫—Ä—ã—Ç—å /client/booking</button>
            <div id="frontend-instructions">
                <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:</strong></p>
                <ol>
                    <li>–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                    <li>–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ "–ö–∏—ó–≤" (ID: 130)</li>
                    <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ</li>
                    <li>–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ —è–∑—ã–∫ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–Ω–æ–≤–∞</li>
                </ol>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üîç –®–∞–≥ 3: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã</h3>
            <button onclick="checkLocalStorage()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage</button>
            <button onclick="checkConsole()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å</button>
            <div id="diagnostic-result" class="api-result"></div>
        </div>
        
        <div class="test-section">
            <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <div id="test-results"></div>
        </div>
    </div>

    <script>
        let currentLanguage = localStorage.getItem('i18nextLng') || 'ru';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateLanguageButtons();
            updateTestResults();
        });
        
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('i18nextLng', lang);
            updateLanguageButtons();
            updateTestResults();
        }
        
        function updateLanguageButtons() {
            document.querySelectorAll('.language-switcher button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`lang-${currentLanguage}`).classList.add('active');
        }
        
        async function testCategoriesAPI() {
            const apiResult = document.getElementById('api-result');
            apiResult.innerHTML = '‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API...';
            
            try {
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å –≥–æ—Ä–æ–¥–æ–º –ö–∏–µ–≤ (ID: 130)
                const response = await fetch(`http://localhost:8000/api/v1/service_categories/by_city_id/130?locale=${currentLanguage}`, {
                    headers: {
                        'Accept-Language': currentLanguage
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                let result = `‚úÖ API Response (${response.status}):\n`;
                result += `–Ø–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–∞: ${currentLanguage}\n`;
                result += `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${data.data ? data.data.length : 0}\n\n`;
                
                if (data.data && data.data.length > 0) {
                    data.data.forEach((category, index) => {
                        result += `–ö–∞—Ç–µ–≥–æ—Ä–∏—è ${index + 1}:\n`;
                        result += `  ID: ${category.id}\n`;
                        result += `  name: ${category.name}\n`;
                        result += `  name_uk: ${category.name_uk}\n`;
                        result += `  localized_name: ${category.localized_name}\n`;
                        result += `  localized_description: ${category.localized_description}\n`;
                        result += `  ‚úÖ –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç: ${category.localized_name !== category.name ? '–î–∞' : '–ù–µ—Ç'}\n\n`;
                    });
                } else {
                    result += '‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö';
                }
                
                apiResult.innerHTML = result;
                
            } catch (error) {
                apiResult.innerHTML = `‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`;
            }
        }
        
        function openBookingPage() {
            window.open('http://localhost:3008/client/booking', '_blank');
        }
        
        function checkLocalStorage() {
            const diagnostic = document.getElementById('diagnostic-result');
            let result = 'üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ localStorage:\n\n';
            
            result += `i18nextLng: ${localStorage.getItem('i18nextLng') || '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}\n`;
            result += `–î—Ä—É–≥–∏–µ –∫–ª—é—á–∏: ${Object.keys(localStorage).join(', ')}\n\n`;
            
            result += 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ sessionStorage:\n';
            result += `–ö–ª—é—á–∏: ${Object.keys(sessionStorage).join(', ')}\n\n`;
            
            result += 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —è–∑—ã–∫–∞:\n';
            result += `–¢–µ–∫—É—â–∏–π —è–∑—ã–∫: ${currentLanguage}\n`;
            result += `navigator.language: ${navigator.language}\n`;
            
            diagnostic.innerHTML = result;
        }
        
        function checkConsole() {
            const diagnostic = document.getElementById('diagnostic-result');
            diagnostic.innerHTML = 'üîç –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å:\n\n';
            diagnostic.innerHTML += '‚Ä¢ RTK Query –∑–∞–ø—Ä–æ—Å—ã\n';
            diagnostic.innerHTML += '‚Ä¢ –û—à–∏–±–∫–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏\n';
            diagnostic.innerHTML += '‚Ä¢ –ü—Ä–æ–±–ª–µ–º—ã —Å API\n';
            diagnostic.innerHTML += '‚Ä¢ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è React\n\n';
            diagnostic.innerHTML += '–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.';
        }
        
        function updateTestResults() {
            const results = document.getElementById('test-results');
            results.innerHTML = `
                <p><strong>–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</strong></p>
                <ul>
                    <li>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: ${currentLanguage}</li>
                    <li>localStorage i18nextLng: ${localStorage.getItem('i18nextLng') || '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</li>
                    <li>API endpoint: /api/v1/service_categories/by_city_id/130?locale=${currentLanguage}</li>
                </ul>
                
                <p><strong>–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:</strong></p>
                <ul>
                    <li>RU: "–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è" ‚Üí "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" ‚Üí "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ"</li>
                    <li>UK: "–¢–µ—Å—Ç–æ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è" ‚Üí "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" ‚Üí "–¢–µ—Ö–Ω—ñ—á–Ω–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è"</li>
                </ul>
            `;
        }
    </script>
</body>
</html> 