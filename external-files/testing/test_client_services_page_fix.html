<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã /client/services</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #1976d2;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .success {
            color: #4caf50;
            background-color: #e8f5e8;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error {
            color: #f44336;
            background-color: #ffebee;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info {
            color: #2196f3;
            background-color: #e3f2fd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .test-button {
            background-color: #1976d2;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background-color: #1565c0;
        }
        .api-response {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        .filter-test {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .filter-test select, .filter-test input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã /client/services</h1>
    <p><strong>–î–∞—Ç–∞:</strong> <span id="currentDate"></span></p>

    <div class="test-section">
        <h2 class="test-title">1. –ü—Ä–æ–≤–µ—Ä–∫–∞ API –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤</h2>
        <p>–¢–µ—Å—Ç: –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>
        <button class="test-button" onclick="testAllServicePoints()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏</button>
        <div id="allServicePointsResult"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
        <p>–¢–µ—Å—Ç: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥</p>
        <div class="filter-test">
            <select id="categoryFilter">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                <option value="1">–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂</option>
                <option value="2">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</option>
                <option value="3">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
            </select>
            <button class="test-button" onclick="testCategoryFilter()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        </div>
        <div id="categoryFilterResult"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ä–æ–¥—É</h2>
        <p>–¢–µ—Å—Ç: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –ø–æ –≥–æ—Ä–æ–¥—É</p>
        <div class="filter-test">
            <select id="cityFilter">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                <option value="–ö–∏—ó–≤">–ö–∏—ó–≤</option>
                <option value="–û–¥–µ—Å–∞">–û–¥–µ—Å–∞</option>
                <option value="–•–∞—Ä–∫—ñ–≤">–•–∞—Ä–∫—ñ–≤</option>
                <option value="–î–Ω—ñ–ø—Ä–æ">–î–Ω—ñ–ø—Ä–æ</option>
                <option value="–õ—å–≤—ñ–≤">–õ—å–≤—ñ–≤</option>
            </select>
            <button class="test-button" onclick="testCityFilter()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        </div>
        <div id="cityFilterResult"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</h2>
        <p>–¢–µ—Å—Ç: –ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –≥–æ—Ä–æ–¥—É</p>
        <div class="filter-test">
            <select id="combinedCategoryFilter">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                <option value="1">–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂</option>
                <option value="2">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</option>
                <option value="3">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
            </select>
            <select id="combinedCityFilter">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                <option value="–ö–∏—ó–≤">–ö–∏—ó–≤</option>
                <option value="–û–¥–µ—Å–∞">–û–¥–µ—Å–∞</option>
                <option value="–•–∞—Ä–∫—ñ–≤">–•–∞—Ä–∫—ñ–≤</option>
            </select>
            <button class="test-button" onclick="testCombinedFilter()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
        </div>
        <div id="combinedFilterResult"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–ø–∏—Å–∫–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤</h2>
        <p>–¢–µ—Å—Ç: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –≥–æ—Ä–æ–¥–æ–≤ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤</p>
        <div class="filter-test">
            <button class="test-button" onclick="testDynamicRegions()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–≥–∏–æ–Ω—ã</button>
            <button class="test-button" onclick="testDynamicCities()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ—Ä–æ–¥–∞</button>
            <button class="test-button" onclick="testDynamicFilters()">–¢–µ—Å—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏</button>
        </div>
        <div id="dynamicFiltersResult"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ</h2>
        <p>–¢–µ—Å—Ç: –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ</p>
        <a href="http://localhost:3008/client/services" target="_blank" class="test-button">–û—Ç–∫—Ä—ã—Ç—å /client/services</a>
        <div class="info">
            <strong>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong>
            <ul>
                <li>–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏</li>
                <li>–§–∏–ª—å—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</li>
                <li>–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞</li>
                <li>–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –≥–æ—Ä–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã</li>
                <li>–ö–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
            </ul>
        </div>
    </div>

    <script>
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
        document.getElementById('currentDate').textContent = new Date().toLocaleString('ru-RU');

        const API_BASE = 'http://localhost:8000/api/v1';

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResult(elementId, data, isSuccess = true) {
            const element = document.getElementById(elementId);
            const resultClass = isSuccess ? 'success' : 'error';
            const resultText = isSuccess ? '–£—Å–ø–µ—à–Ω–æ' : '–û—à–∏–±–∫–∞';
            
            element.innerHTML = `
                <div class="${resultClass}">
                    <strong>${resultText}:</strong> ${typeof data === 'string' ? data : ''}
                </div>
                <div class="api-response">${JSON.stringify(data, null, 2)}</div>
            `;
        }

        // –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫
        async function testAllServicePoints() {
            try {
                const response = await fetch(`${API_BASE}/service_points/search`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('allServicePointsResult', 
                        `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.length} —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏–∑ ${data.total} –æ–±—â–∏—Ö`, true);
                } else {
                    displayResult('allServicePointsResult', data, false);
                }
            } catch (error) {
                displayResult('allServicePointsResult', error.message, false);
            }
        }

        // –¢–µ—Å—Ç 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        async function testCategoryFilter() {
            const categoryId = document.getElementById('categoryFilter').value;
            if (!categoryId) {
                displayResult('categoryFilterResult', '–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é', false);
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/service_points/search?category_id=${categoryId}`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('categoryFilterResult', 
                        `–ù–∞–π–¥–µ–Ω–æ ${data.data.length} —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${categoryId}`, true);
                } else {
                    displayResult('categoryFilterResult', data, false);
                }
            } catch (error) {
                displayResult('categoryFilterResult', error.message, false);
            }
        }

        // –¢–µ—Å—Ç 3: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ—Ä–æ–¥—É
        async function testCityFilter() {
            const city = document.getElementById('cityFilter').value;
            if (!city) {
                displayResult('cityFilterResult', '–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥', false);
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/service_points/search?city=${encodeURIComponent(city)}`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('cityFilterResult', 
                        `–ù–∞–π–¥–µ–Ω–æ ${data.data.length} —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ –≥–æ—Ä–æ–¥–µ ${city}`, true);
                } else {
                    displayResult('cityFilterResult', data, false);
                }
            } catch (error) {
                displayResult('cityFilterResult', error.message, false);
            }
        }

        // –¢–µ—Å—Ç 4: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
        async function testCombinedFilter() {
            const categoryId = document.getElementById('combinedCategoryFilter').value;
            const city = document.getElementById('combinedCityFilter').value;
            
            if (!categoryId && !city) {
                displayResult('combinedFilterResult', '–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ñ–∏–ª—å—Ç—Ä', false);
                return;
            }

            try {
                const params = new URLSearchParams();
                if (categoryId) params.append('category_id', categoryId);
                if (city) params.append('city', city);
                
                const response = await fetch(`${API_BASE}/service_points/search?${params.toString()}`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('combinedFilterResult', 
                        `–ù–∞–π–¥–µ–Ω–æ ${data.data.length} —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ —Å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏`, true);
                } else {
                    displayResult('combinedFilterResult', data, false);
                }
            } catch (error) {
                displayResult('combinedFilterResult', error.message, false);
            }
        }

        // –¢–µ—Å—Ç 5: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ø–∏—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        async function testDynamicRegions() {
            try {
                const response = await fetch(`${API_BASE}/service_points/regions`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('dynamicFiltersResult', 
                        `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.length} —Ä–µ–≥–∏–æ–Ω–æ–≤`, true);
                } else {
                    displayResult('dynamicFiltersResult', data, false);
                }
            } catch (error) {
                displayResult('dynamicFiltersResult', error.message, false);
            }
        }

        async function testDynamicCities() {
            try {
                const response = await fetch(`${API_BASE}/service_points/cities`);
                const data = await response.json();
                
                if (response.ok) {
                    displayResult('dynamicFiltersResult', 
                        `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.length} –≥–æ—Ä–æ–¥–æ–≤`, true);
                } else {
                    displayResult('dynamicFiltersResult', data, false);
                }
            } catch (error) {
                displayResult('dynamicFiltersResult', error.message, false);
            }
        }

        async function testDynamicFilters() {
            try {
                // –¢–µ—Å—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const regionsResponse = await fetch(`${API_BASE}/service_points/regions?category_id=1`);
                const regionsData = await regionsResponse.json();
                
                const citiesResponse = await fetch(`${API_BASE}/service_points/cities?category_id=1`);
                const citiesData = await citiesResponse.json();
                
                if (regionsResponse.ok && citiesResponse.ok) {
                    displayResult('dynamicFiltersResult', 
                        `–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 1: ${regionsData.data.length} —Ä–µ–≥–∏–æ–Ω–æ–≤, ${citiesData.data.length} –≥–æ—Ä–æ–¥–æ–≤`, true);
                } else {
                    displayResult('dynamicFiltersResult', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤', false);
                }
            } catch (error) {
                displayResult('dynamicFiltersResult', error.message, false);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            testAllServicePoints();
        });
    </script>
</body>
</html> 