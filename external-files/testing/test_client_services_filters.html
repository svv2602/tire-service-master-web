<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /client/services</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #1976d2;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .api-test {
            background: #f0f8ff;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #1976d2;
            border-radius: 4px;
        }
        .api-url {
            font-family: monospace;
            background: #e8e8e8;
            padding: 8px;
            border-radius: 4px;
            word-break: break-all;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .test-button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #1565c0;
        }
        .filter-scenario {
            background: #fff3cd;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
        }
        .scenario-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /client/services</h1>
    <p>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫</p>

    <div class="test-section">
        <h2 class="test-title">1. –¢–µ—Å—Ç API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤</h2>
        
        <div class="api-test">
            <h3>–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —É—Å–ª—É–≥</h3>
            <div class="api-url">GET /api/v1/service_categories</div>
            <button class="test-button" onclick="testCategories()">–¢–µ—Å—Ç</button>
            <div id="categories-result" class="result"></div>
        </div>

        <div class="api-test">
            <h3>–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏</h3>
            <div class="api-url">GET /api/v1/service_points/regions</div>
            <button class="test-button" onclick="testRegions()">–¢–µ—Å—Ç</button>
            <div id="regions-result" class="result"></div>
        </div>

        <div class="api-test">
            <h3>–ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤ —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏</h3>
            <div class="api-url">GET /api/v1/service_points/cities</div>
            <button class="test-button" onclick="testCities()">–¢–µ—Å—Ç</button>
            <div id="cities-result" class="result"></div>
        </div>

        <div class="api-test">
            <h3>–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å–ª—É–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
            <div class="api-url">GET /api/v1/services?category_id=1</div>
            <button class="test-button" onclick="testServices()">–¢–µ—Å—Ç</button>
            <div id="services-result" class="result"></div>
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">2. –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫</h2>
        
        <div class="api-test">
            <h3>–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É</h3>
            <div class="api-url">GET /api/v1/service_points/search?city=–ö–∏—ó–≤</div>
            <button class="test-button" onclick="testSearchByCity()">–¢–µ—Å—Ç</button>
            <div id="search-city-result" class="result"></div>
        </div>

        <div class="api-test">
            <h3>–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
            <div class="api-url">GET /api/v1/service_points/search?city=–ö–∏—ó–≤&category_id=1</div>
            <button class="test-button" onclick="testSearchByCityAndCategory()">–¢–µ—Å—Ç</button>
            <div id="search-city-category-result" class="result"></div>
        </div>

        <div class="api-test">
            <h3>–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —É—Å–ª—É–≥–µ</h3>
            <div class="api-url">GET /api/v1/service_points/search?city=–ö–∏—ó–≤&category_id=1&service_id=6</div>
            <button class="test-button" onclick="testSearchByCityAndCategoryAndService()">–¢–µ—Å—Ç</button>
            <div id="search-full-result" class="result"></div>
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">3. –¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</h2>
        
        <div class="filter-scenario">
            <div class="scenario-title">–°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤</div>
            <button class="test-button" onclick="testDynamicRegions()">–¢–µ—Å—Ç</button>
            <div id="dynamic-regions-result" class="result"></div>
        </div>

        <div class="filter-scenario">
            <div class="scenario-title">–°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤</div>
            <button class="test-button" onclick="testDynamicCities()">–¢–µ—Å—Ç</button>
            <div id="dynamic-cities-result" class="result"></div>
        </div>

        <div class="filter-scenario">
            <div class="scenario-title">–°—Ü–µ–Ω–∞—Ä–∏–π 3: –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ä–µ–≥–∏–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –≥–æ—Ä–æ–¥–∞</div>
            <button class="test-button" onclick="testDynamicCitiesWithFilters()">–¢–µ—Å—Ç</button>
            <div id="dynamic-cities-filters-result" class="result"></div>
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">4. –¢–µ—Å—Ç –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ</h2>
        <button class="test-button" onclick="testAllFilters()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
        <div id="all-tests-result" class="result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000/api/v1';

        async function apiRequest(url) {
            try {
                const response = await fetch(`${API_BASE}${url}`);
                const data = await response.json();
                return { success: true, data };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        function displayResult(elementId, result, message) {
            const element = document.getElementById(elementId);
            if (result.success) {
                element.className = 'result success';
                element.innerHTML = `‚úÖ ${message}<br>–î–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–µ–Ω–æ: ${result.data.data ? result.data.data.length : 'N/A'}`;
            } else {
                element.className = 'result error';
                element.innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${result.error}`;
            }
        }

        async function testCategories() {
            const result = await apiRequest('/service_categories');
            displayResult('categories-result', result, '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        }

        async function testRegions() {
            const result = await apiRequest('/service_points/regions');
            displayResult('regions-result', result, '–†–µ–≥–∏–æ–Ω—ã —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        }

        async function testCities() {
            const result = await apiRequest('/service_points/cities');
            displayResult('cities-result', result, '–ì–æ—Ä–æ–¥–∞ —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        }

        async function testServices() {
            const result = await apiRequest('/services?category_id=1');
            displayResult('services-result', result, '–£—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        }

        async function testSearchByCity() {
            const result = await apiRequest('/service_points/search?city=–ö–∏—ó–≤');
            displayResult('search-city-result', result, '–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω');
        }

        async function testSearchByCityAndCategory() {
            const result = await apiRequest('/service_points/search?city=–ö–∏—ó–≤&category_id=1');
            displayResult('search-city-category-result', result, '–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω');
        }

        async function testSearchByCityAndCategoryAndService() {
            const result = await apiRequest('/service_points/search?city=–ö–∏—ó–≤&category_id=1&service_id=6');
            displayResult('search-full-result', result, '–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Ñ–∏–ª—å—Ç—Ä–∞–º –≤—ã–ø–æ–ª–Ω–µ–Ω');
        }

        async function testDynamicRegions() {
            const allRegions = await apiRequest('/service_points/regions');
            const filteredRegions = await apiRequest('/service_points/regions?category_id=1');
            
            const element = document.getElementById('dynamic-regions-result');
            if (allRegions.success && filteredRegions.success) {
                const allCount = allRegions.data.data.length;
                const filteredCount = filteredRegions.data.data.length;
                element.className = 'result success';
                element.innerHTML = `‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç<br>–í—Å–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–æ–≤: ${allCount}, —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π 1: ${filteredCount}`;
            } else {
                element.className = 'result error';
                element.innerHTML = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤';
            }
        }

        async function testDynamicCities() {
            const allCities = await apiRequest('/service_points/cities');
            const filteredCities = await apiRequest('/service_points/cities?region_id=1');
            
            const element = document.getElementById('dynamic-cities-result');
            if (allCities.success && filteredCities.success) {
                const allCount = allCities.data.data.length;
                const filteredCount = filteredCities.data.data.length;
                element.className = 'result success';
                element.innerHTML = `‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≥–æ—Ä–æ–¥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç<br>–í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤: ${allCount}, –≤ —Ä–µ–≥–∏–æ–Ω–µ 1: ${filteredCount}`;
            } else {
                element.className = 'result error';
                element.innerHTML = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥–æ—Ä–æ–¥–æ–≤';
            }
        }

        async function testDynamicCitiesWithFilters() {
            const result = await apiRequest('/service_points/cities?category_id=1&region_id=1');
            
            const element = document.getElementById('dynamic-cities-filters-result');
            if (result.success) {
                element.className = 'result success';
                element.innerHTML = `‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç<br>–ì–æ—Ä–æ–¥–æ–≤ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π 1 –≤ —Ä–µ–≥–∏–æ–Ω–µ 1: ${result.data.data.length}`;
            } else {
                element.className = 'result error';
                element.innerHTML = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏';
            }
        }

        async function testAllFilters() {
            const element = document.getElementById('all-tests-result');
            element.innerHTML = '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...';
            
            const tests = [
                { name: '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏', test: testCategories },
                { name: '–†–µ–≥–∏–æ–Ω—ã', test: testRegions },
                { name: '–ì–æ—Ä–æ–¥–∞', test: testCities },
                { name: '–£—Å–ª—É–≥–∏', test: testServices },
                { name: '–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É', test: testSearchByCity },
                { name: '–ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏', test: testSearchByCityAndCategory },
                { name: '–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è', test: testDynamicRegions }
            ];

            const results = [];
            for (const test of tests) {
                try {
                    await test.test();
                    results.push(`‚úÖ ${test.name}`);
                } catch (error) {
                    results.push(`‚ùå ${test.name}: ${error.message}`);
                }
            }

            element.className = 'result success';
            element.innerHTML = `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:</strong><br>${results.join('<br>')}`;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ /client/services –∑–∞–≥—Ä—É–∂–µ–Ω–æ');
        };
    </script>
</body>
</html> 