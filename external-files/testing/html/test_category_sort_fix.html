<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { border-color: #4caf50; background-color: #f1f8e9; }
        .error { border-color: #f44336; background-color: #ffebee; }
        .warning { border-color: #ff9800; background-color: #fff3e0; }
        .info { border-color: #2196f3; background-color: #e3f2fd; }
        
        button {
            background-color: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background-color: #1565c0; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        
        .category-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .category-name { font-weight: bold; }
        .category-id { color: #666; font-size: 0.9em; }
        
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h1>
        <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /client/services</p>
    </div>

    <div class="container test-section info">
        <h2>üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</h2>
        <p><strong>–ë—ã–ª–æ:</strong> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –ø–æ—Ä—è–¥–∫–µ –ø–æ ID (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ ‚Üí –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ ‚Üí –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)</p>
        <p><strong>–°—Ç–∞–ª–æ:</strong> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ (–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ ‚Üí –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏)</p>
    </div>

    <div class="container test-section">
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h2>
        <button onclick="testCategoriesAPI()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ API</button>
        <div id="categoriesResult"></div>
    </div>

    <div class="container test-section">
        <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h2>
        <button onclick="testCategorySorting()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É</button>
        <div id="sortingResult"></div>
    </div>

    <div class="container test-section">
        <h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"</h2>
        <button onclick="testTireMountingFilter()">–¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"</button>
        <div id="tireMountingResult"></div>
    </div>

    <div class="container test-section">
        <h2>4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞</h2>
        <button onclick="testCombinedFilter()">–¢–µ—Å—Ç "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" + "–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å"</button>
        <div id="combinedResult"></div>
    </div>

    <div class="container test-section">
        <h2>5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤</h2>
        <button onclick="testDynamicRegions()">–¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤</button>
        <div id="regionsResult"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000/api/v1';
        
        async function apiRequest(url) {
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        async function testCategoriesAPI() {
            const resultDiv = document.getElementById('categoriesResult');
            resultDiv.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_categories?active=true&per_page=50`);
                const categories = data.data || [];
                
                let html = '<div class="test-result success">';
                html += '<h3>‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ</h3>';
                html += '<p><strong>–ü–æ—Ä—è–¥–æ–∫ –≤–æ–∑–≤—Ä–∞—Ç–∞ API:</strong></p>';
                
                categories.forEach((category, index) => {
                    html += `<div class="category-item">
                        <span class="category-name">${index + 1}. ${category.name}</span>
                        <span class="category-id">ID: ${category.id}</span>
                    </div>`;
                });
                
                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="test-result error">
                    <h3>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h3>
                    <p>${error.message}</p>
                </div>`;
            }
        }

        async function testCategorySorting() {
            const resultDiv = document.getElementById('sortingResult');
            resultDiv.innerHTML = '<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏...</p>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_categories?active=true&per_page=50`);
                const categories = data.data || [];
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç—É –∂–µ –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, —á—Ç–æ –∏ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
                const categoryOrder = ['–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂', '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ', '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏'];
                const sortedCategories = [...categories].sort((a, b) => {
                    const indexA = categoryOrder.indexOf(a.name);
                    const indexB = categoryOrder.indexOf(b.name);
                    
                    if (indexA === -1 && indexB === -1) return 0;
                    if (indexA === -1) return 1;
                    if (indexB === -1) return -1;
                    
                    return indexA - indexB;
                });
                
                let html = '<div class="test-result success">';
                html += '<h3>‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ</h3>';
                html += '<p><strong>–ü–æ—Ä—è–¥–æ–∫ –ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:</strong></p>';
                
                sortedCategories.forEach((category, index) => {
                    html += `<div class="category-item">
                        <span class="category-name">${index + 1}. ${category.name}</span>
                        <span class="category-id">ID: ${category.id}</span>
                    </div>`;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–≤—ã–π
                if (sortedCategories[0]?.name === '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂') {
                    html += '<p style="color: #4caf50; font-weight: bold;">‚úÖ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ!</p>';
                } else {
                    html += '<p style="color: #f44336; font-weight: bold;">‚ùå "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" –Ω–µ –ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ</p>';
                }
                
                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="test-result error">
                    <h3>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</h3>
                    <p>${error.message}</p>
                </div>`;
            }
        }

        async function testTireMountingFilter() {
            const resultDiv = document.getElementById('tireMountingResult');
            resultDiv.innerHTML = '<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"...</p>';
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º —É—Å–ª—É–≥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" (ID=3)
                const servicesData = await apiRequest(`${API_BASE}/service_categories/3/services`);
                const services = servicesData.data || [];
                
                // –ó–∞—Ç–µ–º –∏—â–µ–º —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π
                const searchData = await apiRequest(`${API_BASE}/service_points/search?category_id=3`);
                const servicePoints = searchData.data || [];
                
                let html = '<div class="test-result success">';
                html += '<h3>‚úÖ –§–∏–ª—å—Ç—Ä "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>';
                html += `<p><strong>–ù–∞–π–¥–µ–Ω–æ —É—Å–ª—É–≥:</strong> ${services.length}</p>`;
                html += '<ul>';
                services.forEach(service => {
                    html += `<li>${service.name} (ID: ${service.id})</li>`;
                });
                html += '</ul>';
                
                html += `<p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫:</strong> ${servicePoints.length}</p>`;
                servicePoints.forEach(point => {
                    html += `<p>‚Ä¢ ${point.name} - ${point.city?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ—Ä–æ–¥'}</p>`;
                });
                
                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="test-result error">
                    <h3>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞</h3>
                    <p>${error.message}</p>
                </div>`;
            }
        }

        async function testCombinedFilter() {
            const resultDiv = document.getElementById('combinedResult');
            resultDiv.innerHTML = '<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞...</p>';
            
            try {
                // –¢–µ—Å—Ç —Å category_id=3 (–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂) –∏ service_id=2 (–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å)
                const searchData = await apiRequest(`${API_BASE}/service_points/search?category_id=3&service_id=2`);
                const servicePoints = searchData.data || [];
                
                let html = '<div class="test-result success">';
                html += '<h3>‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>';
                html += '<p><strong>–§–∏–ª—å—Ç—Ä:</strong> –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (ID=3) + –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å (ID=2)</p>';
                html += `<p><strong>–ù–∞–π–¥–µ–Ω–æ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫:</strong> ${servicePoints.length}</p>`;
                
                if (servicePoints.length > 0) {
                    servicePoints.forEach(point => {
                        html += `<div class="category-item">
                            <span class="category-name">${point.name}</span>
                            <span class="category-id">${point.city?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ—Ä–æ–¥'}</span>
                        </div>`;
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ
                    const dniproPoint = servicePoints.find(p => p.city?.name === '–î–Ω—ñ–ø—Ä–æ');
                    if (dniproPoint) {
                        html += '<p style="color: #4caf50; font-weight: bold;">‚úÖ –ù–∞–π–¥–µ–Ω–∞ —Å–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ!</p>';
                    } else {
                        html += '<p style="color: #ff9800; font-weight: bold;">‚ö†Ô∏è –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</p>';
                    }
                } else {
                    html += '<p style="color: #ff9800;">‚ö†Ô∏è –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                }
                
                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="test-result error">
                    <h3>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞</h3>
                    <p>${error.message}</p>
                </div>`;
            }
        }

        async function testDynamicRegions() {
            const resultDiv = document.getElementById('regionsResult');
            resultDiv.innerHTML = '<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤...</p>';
            
            try {
                // –¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
                const regionsData = await apiRequest(`${API_BASE}/service_points/regions?category_id=3&service_id=2`);
                const regions = regionsData.data || [];
                
                let html = '<div class="test-result success">';
                html += '<h3>‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç</h3>';
                html += '<p><strong>–§–∏–ª—å—Ç—Ä:</strong> –®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂ (ID=3) + –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å (ID=2)</p>';
                html += `<p><strong>–ù–∞–π–¥–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–æ–≤:</strong> ${regions.length}</p>`;
                
                regions.forEach(region => {
                    html += `<div class="category-item">
                        <span class="category-name">${region.name}</span>
                        <span class="category-id">ID: ${region.id}</span>
                    </div>`;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –µ—Å—Ç—å –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
                const dniproRegion = regions.find(r => r.name.includes('–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞'));
                if (dniproRegion) {
                    html += '<p style="color: #4caf50; font-weight: bold;">‚úÖ –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å –Ω–∞–π–¥–µ–Ω–∞!</p>';
                } else {
                    html += '<p style="color: #ff9800; font-weight: bold;">‚ö†Ô∏è –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞</p>';
                }
                
                html += '</div>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="test-result error">
                    <h3>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤</h3>
                    <p>${error.message}</p>
                </div>`;
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø–µ—Ä–≤–æ–≥–æ —Ç–µ—Å—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            testCategoriesAPI();
        });
    </script>
</body>
</html> 