<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–µ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-title {
            color: #1976d2;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .test-link {
            display: inline-block;
            background: #1976d2;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 4px;
            margin: 5px 10px 5px 0;
        }
        .test-link:hover {
            background: #1565c0;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status.success {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            color: #2e7d32;
        }
        .status.info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            color: #1565c0;
        }
        .api-test {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .checklist {
            list-style-type: none;
            padding: 0;
        }
        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .checklist li:before {
            content: "‚úì ";
            color: #4caf50;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç –¢–µ—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–µ</h1>
        
        <div class="test-section">
            <div class="test-title">üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å</div>
            <ul class="checklist">
                <li>–ö–Ω–æ–ø–∫–∏ "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è" –≤–µ–¥—É—Ç –Ω–∞ —Ñ–æ—Ä–º—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
                <li>–í –∞–¥—Ä–µ—Å–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≥–æ—Ä–æ–¥ (—Ñ–æ—Ä–º–∞—Ç: "–ì–æ—Ä–æ–¥, –£–ª–∏—Ü–∞")</li>
                <li>–ë–ª–æ–∫–∏ —É—Å–ª—É–≥ –Ω–µ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ä—Ç–æ—á–∫–∏</li>
                <li>–£—Å–ª—É–≥–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</li>
                <li>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å ClientLayout</li>
            </ul>
        </div>

        <div class="test-section">
            <div class="test-title">üåê –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
            <a href="http://localhost:3008/client/service-point/1" class="test-link" target="_blank">
                –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ ID=1 (–®–∏–Ω–æ–°–µ—Ä–≤—ñ—Å –ï–∫—Å–ø—Ä–µ—Å)
            </a>
            <a href="http://localhost:3008/client/service-point/2" class="test-link" target="_blank">
                –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ ID=2
            </a>
            <a href="http://localhost:3008/client/service-point/3" class="test-link" target="_blank">
                –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ ID=3
            </a>
        </div>

        <div class="test-section">
            <div class="test-title">üîß API —Ç–µ—Å—Ç—ã</div>
            <div id="api-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">üìù –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
            <div class="status info">
                <strong>–ê–¥—Ä–µ—Å:</strong> –î–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ "–ö–∏—ó–≤, –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 22"
            </div>
            <div class="status info">
                <strong>–ö–Ω–æ–ø–∫–∏ "–ó–∞–ø–∏—Å–∞—Ç—å—Å—è":</strong> –î–æ–ª–∂–Ω—ã –≤–µ—Å—Ç–∏ –Ω–∞ /client/booking/new-with-availability —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
            </div>
            <div class="status info">
                <strong>–£—Å–ª—É–≥–∏:</strong> –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂, –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º API
        async function testAPI() {
            const apiResults = document.getElementById('api-results');
            
            try {
                // –¢–µ—Å—Ç API —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
                const servicePointResponse = await fetch('http://localhost:8000/api/v1/service_points/1');
                const servicePointData = await servicePointResponse.json();
                
                apiResults.innerHTML += `
                    <div class="api-test">
                        <strong>‚úÖ API —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏:</strong><br>
                        ID: ${servicePointData.id}<br>
                        –ù–∞–∑–≤–∞–Ω–∏–µ: ${servicePointData.name}<br>
                        –ê–¥—Ä–µ—Å: ${servicePointData.address}<br>
                        City ID: ${servicePointData.city?.id}<br>
                        –£—Å–ª—É–≥: ${servicePointData.services?.length || 0}
                    </div>
                `;

                // –¢–µ—Å—Ç API –≥–æ—Ä–æ–¥–∞
                if (servicePointData.city?.id) {
                    const cityResponse = await fetch(`http://localhost:8000/api/v1/cities/${servicePointData.city.id}`);
                    const cityData = await cityResponse.json();
                    
                    apiResults.innerHTML += `
                        <div class="api-test">
                            <strong>‚úÖ API –≥–æ—Ä–æ–¥–∞:</strong><br>
                            ID: ${cityData.data.id}<br>
                            –ù–∞–∑–≤–∞–Ω–∏–µ: ${cityData.data.name}<br>
                            –û–∂–∏–¥–∞–µ–º—ã–π –∞–¥—Ä–µ—Å: ${cityData.data.name}, ${servicePointData.address}
                        </div>
                    `;
                }

                // –¢–µ—Å—Ç API —É—Å–ª—É–≥
                const servicesResponse = await fetch('http://localhost:8000/api/v1/service_points/1/services');
                const servicesData = await servicesResponse.json();
                
                const categories = {};
                servicesData.forEach(service => {
                    if (service.category) {
                        if (!categories[service.category.name]) {
                            categories[service.category.name] = [];
                        }
                        categories[service.category.name].push(service);
                    }
                });

                apiResults.innerHTML += `
                    <div class="api-test">
                        <strong>‚úÖ API —É—Å–ª—É–≥:</strong><br>
                        –í—Å–µ–≥–æ —É—Å–ª—É–≥: ${servicesData.length}<br>
                        –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: ${Object.keys(categories).join(', ')}<br>
                        –£—Å–ª—É–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:<br>
                        ${Object.entries(categories).map(([catName, services]) => 
                            `&nbsp;&nbsp;‚Ä¢ ${catName}: ${services.length} —É—Å–ª—É–≥`
                        ).join('<br>')}
                    </div>
                `;

            } catch (error) {
                apiResults.innerHTML += `
                    <div class="api-test" style="background: #ffebee; border: 1px solid #f44336;">
                        <strong>‚ùå –û—à–∏–±–∫–∞ API:</strong> ${error.message}
                    </div>
                `;
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = testAPI;
    </script>
</body>
</html> 