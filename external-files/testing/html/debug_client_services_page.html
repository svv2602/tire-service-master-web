<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã /client/services</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { border-color: #4caf50; background-color: #f1f8e9; }
        .error { border-color: #f44336; background-color: #ffebee; }
        .warning { border-color: #ff9800; background-color: #fff3e0; }
        .info { border-color: #2196f3; background-color: #e3f2fd; }
        
        button {
            background-color: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background-color: #1565c0; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .category-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .category-name { font-weight: bold; }
        .category-id { color: #666; font-size: 0.9em; }
        
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        
        .step {
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-left: 4px solid #2196f3;
        }
        
        .step-title {
            font-weight: bold;
            color: #1976d2;
        }
        
        .step-result {
            margin-top: 5px;
            font-family: monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç –û—Ç–ª–∞–¥–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã /client/services</h1>
        <p>–ü–æ—à–∞–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API –∏ –ª–æ–≥–∏–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞</p>
    </div>

    <div class="container test-section info">
        <h2>üìã –ü—Ä–æ–±–ª–µ–º–∞</h2>
        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" + "–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å", –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>
        <p><strong>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ù–∞–π—Ç–∏ 1 —Å–µ—Ä–≤–∏—Å–Ω—É—é —Ç–æ—á–∫—É –≤ –î–Ω–µ–ø—Ä–µ</p>
        <p><strong>–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</p>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h2>
        <button onclick="testStep1()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
        <div id="step1Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ API —É—Å–ª—É–≥ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"</h2>
        <button onclick="testStep2()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —É—Å–ª—É–≥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ID=3</button>
        <div id="step2Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∏—Å–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏</h2>
        <button onclick="testStep3()">–¢–µ—Å—Ç category_id=3 + service_id=2</button>
        <div id="step3Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤</h2>
        <button onclick="testStep4()">–¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤</button>
        <div id="step4Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤</h2>
        <button onclick="testStep5()">–¢–µ—Å—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤</button>
        <div id="step5Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 6: –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è</h2>
        <button onclick="testStep6()">–ü–æ–ª–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <div id="step6Result"></div>
    </div>

    <div class="container test-section">
        <h2>–®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–≥–∏–∫–∏</h2>
        <button onclick="testStep7()">–¢–µ—Å—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</button>
        <div id="step7Result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000/api/v1';
        
        async function apiRequest(url) {
            try {
                console.log(`üîç API Request: ${url}`);
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const data = await response.json();
                console.log(`‚úÖ API Response:`, data);
                return data;
            } catch (error) {
                console.error('‚ùå API Error:', error);
                throw error;
            }
        }

        function showResult(elementId, content, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="test-result ${isSuccess ? 'success' : 'error'}">${content}</div>`;
        }

        async function testStep1() {
            const resultDiv = document.getElementById('step1Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</div></div>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_categories?active=true&per_page=50`);
                const categories = data.data || [];
                
                let html = '<div class="step success">';
                html += '<div class="step-title">‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>';
                html += '<div class="step-result">';
                html += `<strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> ${categories.length}<br>`;
                html += '<strong>–ü–æ—Ä—è–¥–æ–∫ API:</strong><br>';
                categories.forEach((category, index) => {
                    html += `${index + 1}. ${category.name} (ID: ${category.id})<br>`;
                });
                html += '</div></div>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
                window.testData = { categories };
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step1Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep2() {
            const resultDiv = document.getElementById('step2Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ó–∞–≥—Ä—É–∑–∫–∞ —É—Å–ª—É–≥...</div></div>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_categories/3/services`);
                const services = data.data || [];
                
                let html = '<div class="step success">';
                html += '<div class="step-title">‚úÖ –£—Å–ª—É–≥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>';
                html += '<div class="step-result">';
                html += `<strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> ${services.length}<br>`;
                html += '<strong>–°–ø–∏—Å–æ–∫ —É—Å–ª—É–≥:</strong><br>';
                services.forEach((service, index) => {
                    html += `${index + 1}. ${service.name} (ID: ${service.id})<br>`;
                });
                html += '</div></div>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
                if (!window.testData) window.testData = {};
                window.testData.services = services;
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step2Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Å–ª—É–≥</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep3() {
            const resultDiv = document.getElementById('step3Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ü–æ–∏—Å–∫ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫...</div></div>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_points/search?category_id=3&service_id=2`);
                const servicePoints = data.data || [];
                
                let html = '<div class="step success">';
                html += '<div class="step-title">‚úÖ –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω</div>';
                html += '<div class="step-result">';
                html += `<strong>–§–∏–ª—å—Ç—Ä—ã:</strong> category_id=3 (–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂) + service_id=2 (–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å)<br>`;
                html += `<strong>–ù–∞–π–¥–µ–Ω–æ:</strong> ${servicePoints.length} —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫<br>`;
                
                if (servicePoints.length > 0) {
                    html += '<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</strong><br>';
                    servicePoints.forEach((point, index) => {
                        html += `${index + 1}. ${point.name} - ${point.city?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ—Ä–æ–¥'}<br>`;
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –î–Ω–µ–ø—Ä
                    const dniproPoint = servicePoints.find(p => p.city?.name === '–î–Ω—ñ–ø—Ä–æ');
                    if (dniproPoint) {
                        html += '<br><strong style="color: #4caf50;">‚úÖ –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ –Ω–∞–π–¥–µ–Ω–∞!</strong>';
                    } else {
                        html += '<br><strong style="color: #ff9800;">‚ö†Ô∏è –°–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ –ù–ï –Ω–∞–π–¥–µ–Ω–∞</strong>';
                    }
                } else {
                    html += '<br><strong style="color: #f44336;">‚ùå –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</strong>';
                }
                
                html += '</div></div>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
                if (!window.testData) window.testData = {};
                window.testData.servicePoints = servicePoints;
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step3Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep4() {
            const resultDiv = document.getElementById('step4Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤...</div></div>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_points/regions?category_id=3&service_id=2`);
                const regions = data.data || [];
                
                let html = '<div class="step success">';
                html += '<div class="step-title">‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>';
                html += '<div class="step-result">';
                html += `<strong>–§–∏–ª—å—Ç—Ä—ã:</strong> category_id=3 + service_id=2<br>`;
                html += `<strong>–ù–∞–π–¥–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–æ–≤:</strong> ${regions.length}<br>`;
                
                if (regions.length > 0) {
                    html += '<strong>–°–ø–∏—Å–æ–∫ —Ä–µ–≥–∏–æ–Ω–æ–≤:</strong><br>';
                    regions.forEach((region, index) => {
                        html += `${index + 1}. ${region.name} (ID: ${region.id})<br>`;
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å
                    const dniproRegion = regions.find(r => r.name.includes('–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞'));
                    if (dniproRegion) {
                        html += '<br><strong style="color: #4caf50;">‚úÖ –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å –Ω–∞–π–¥–µ–Ω–∞!</strong>';
                    } else {
                        html += '<br><strong style="color: #ff9800;">‚ö†Ô∏è –î–Ω–µ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å –ù–ï –Ω–∞–π–¥–µ–Ω–∞</strong>';
                    }
                } else {
                    html += '<br><strong style="color: #f44336;">‚ùå –†–µ–≥–∏–æ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</strong>';
                }
                
                html += '</div></div>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
                if (!window.testData) window.testData = {};
                window.testData.regions = regions;
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step4Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–≥–∏–æ–Ω–æ–≤</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep5() {
            const resultDiv = document.getElementById('step5Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤...</div></div>';
            
            try {
                const data = await apiRequest(`${API_BASE}/service_points/cities?category_id=3&service_id=2`);
                const cities = data.data || [];
                
                let html = '<div class="step success">';
                html += '<div class="step-title">‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>';
                html += '<div class="step-result">';
                html += `<strong>–§–∏–ª—å—Ç—Ä—ã:</strong> category_id=3 + service_id=2<br>`;
                html += `<strong>–ù–∞–π–¥–µ–Ω–æ –≥–æ—Ä–æ–¥–æ–≤:</strong> ${cities.length}<br>`;
                
                if (cities.length > 0) {
                    html += '<strong>–°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤:</strong><br>';
                    cities.forEach((city, index) => {
                        html += `${index + 1}. ${city.name} (ID: ${city.id})<br>`;
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –î–Ω–µ–ø—Ä
                    const dniproCity = cities.find(c => c.name === '–î–Ω—ñ–ø—Ä–æ');
                    if (dniproCity) {
                        html += '<br><strong style="color: #4caf50;">‚úÖ –î–Ω–µ–ø—Ä –Ω–∞–π–¥–µ–Ω!</strong>';
                    } else {
                        html += '<br><strong style="color: #ff9800;">‚ö†Ô∏è –î–Ω–µ–ø—Ä –ù–ï –Ω–∞–π–¥–µ–Ω</strong>';
                    }
                } else {
                    html += '<br><strong style="color: #f44336;">‚ùå –ì–æ—Ä–æ–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</strong>';
                }
                
                html += '</div></div>';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤
                if (!window.testData) window.testData = {};
                window.testData.cities = cities;
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step5Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ—Ä–æ–¥–æ–≤</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep6() {
            const resultDiv = document.getElementById('step6Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è...</div></div>';
            
            try {
                let html = '<div class="step success">';
                html += '<div class="step-title">üéØ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π</div>';
                html += '<div class="step-result">';
                
                // –®–∞–≥ 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                html += '<strong>–®–∞–≥ 1:</strong> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Å–µ–ª–µ–∫—Ç–µ<br>';
                if (window.testData && window.testData.categories) {
                    const categories = window.testData.categories;
                    html += `- –ü–µ—Ä–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${categories[0]?.name} (ID: ${categories[0]?.id})<br>`;
                    html += `- –í—Ç–æ—Ä–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${categories[1]?.name} (ID: ${categories[1]?.id})<br>`;
                    html += `- –¢—Ä–µ—Ç—å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${categories[2]?.name} (ID: ${categories[2]?.id})<br>`;
                    
                    // –ü—Ä–æ–±–ª–µ–º–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥—É–º–∞–µ—Ç —á—Ç–æ –ø–µ—Ä–≤–∞—è - —ç—Ç–æ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"
                    if (categories[0]?.name !== '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂') {
                        html += '<br><strong style="color: #f44336;">‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ü–µ—Ä–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂"!</strong><br>';
                        html += `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥—É–º–∞–µ—Ç —á—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂", –Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç "${categories[0]?.name}"<br>`;
                    }
                } else {
                    html += '<em>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</em><br>';
                }
                
                // –®–∞–≥ 2: –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—ã–±–æ—Ä–µ
                html += '<br><strong>–®–∞–≥ 2:</strong> –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é<br>';
                if (window.testData && window.testData.categories && window.testData.categories[0]) {
                    const wrongCategory = window.testData.categories[0];
                    html += `- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è category_id=${wrongCategory.id} (${wrongCategory.name})<br>`;
                    html += `- –ù–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∂–∏–¥–∞–µ—Ç category_id=3 (–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂)<br>`;
                }
                
                // –®–∞–≥ 3: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                html += '<br><strong>–®–∞–≥ 3:</strong> –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä<br>';
                html += '- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" (ID=3)<br>';
                html += '- –ó–∞—Ç–µ–º –≤—ã–±—Ä–∞—Ç—å "–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å" (ID=2)<br>';
                html += '- –¢–æ–≥–¥–∞ –Ω–∞–π–¥–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–Ω–∞—è —Ç–æ—á–∫–∞ –≤ –î–Ω–µ–ø—Ä–µ<br>';
                
                html += '</div></div>';
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step6Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        async function testStep7() {
            const resultDiv = document.getElementById('step7Result');
            resultDiv.innerHTML = '<div class="step"><div class="step-title">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–≥–∏–∫–∏...</div></div>';
            
            try {
                let html = '<div class="step success">';
                html += '<div class="step-title">üîß –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–≥–∏–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</div>';
                html += '<div class="step-result">';
                
                if (window.testData && window.testData.categories) {
                    const categories = window.testData.categories;
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
                    const categoryOrder = ['–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂', '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ', '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏'];
                    const sortedCategories = [...categories].sort((a, b) => {
                        const indexA = categoryOrder.indexOf(a.name);
                        const indexB = categoryOrder.indexOf(b.name);
                        
                        if (indexA === -1 && indexB === -1) return 0;
                        if (indexA === -1) return 1;
                        if (indexB === -1) return -1;
                        
                        return indexA - indexB;
                    });
                    
                    html += '<strong>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ API:</strong><br>';
                    categories.forEach((category, index) => {
                        html += `${index + 1}. ${category.name} (ID: ${category.id})<br>`;
                    });
                    
                    html += '<br><strong>–ü–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:</strong><br>';
                    sortedCategories.forEach((category, index) => {
                        html += `${index + 1}. ${category.name} (ID: ${category.id})<br>`;
                    });
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–≤—ã–π
                    if (sortedCategories[0]?.name === '–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂') {
                        html += '<br><strong style="color: #4caf50;">‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! "–®–∏–Ω–æ–º–æ–Ω—Ç–∞–∂" —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–≤—ã–π!</strong><br>';
                        html += '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±–µ—Ä–µ—Ç category_id=3<br>';
                    } else {
                        html += '<br><strong style="color: #f44336;">‚ùå –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</strong><br>';
                    }
                } else {
                    html += '<em>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</em><br>';
                }
                
                html += '</div></div>';
                
                resultDiv.innerHTML = html;
            } catch (error) {
                showResult('step7Result', `<div class="step error">
                    <div class="step-title">‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏</div>
                    <div class="step-result">${error.message}</div>
                </div>`, false);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø–µ—Ä–≤–æ–≥–æ —Ç–µ—Å—Ç–∞
        window.addEventListener('load', () => {
            testStep1();
        });
    </script>
</body>
</html> 