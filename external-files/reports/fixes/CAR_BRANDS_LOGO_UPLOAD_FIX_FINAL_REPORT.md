# üéâ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–ì–†–£–ó–ö–ò –õ–û–ì–û–¢–ò–ü–û–í –ë–†–ï–ù–î–û–í –ê–í–¢–û

## üìÖ –î–∞—Ç–∞: 18 –∏—é–Ω—è 2025
## ‚è∞ –í—Ä–µ–º—è: 13:17

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê (–†–ï–®–ï–ù–ê ‚úÖ)
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª –æ —Ç–æ–º, —á—Ç–æ **–∑–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –¥–ª—è –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**, –ø–æ–ª—É—á–∞—è –æ—à–∏–±–∫—É 400 Bad Request.

---

## üîç –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê
–ü–æ—Å–ª–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤—ã—è–≤–ª–µ–Ω–∞ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤ baseApi.ts**:

### ‚ùå –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```typescript
// –í baseApi.ts –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è Content-Type –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
if (!headers.get('content-type')) {
  headers.set('content-type', 'application/json');  // ‚ùå –õ–æ–º–∞–µ—Ç FormData!
}
```

### ‚úÖ –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```typescript
// –í–ê–ñ–ù–û: –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Type –¥–ª—è FormData!
// RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç FormData –∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç Content-Type,
// –ø–æ–∑–≤–æ–ª—è—è –±—Ä–∞—É–∑–µ—Ä—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ multipart/form-data
```

### üîç –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
–ö–æ–≥–¥–∞ –º—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º `Content-Type: application/json` –¥–ª—è FormData –∑–∞–ø—Ä–æ—Å–æ–≤, –±—Ä–∞—É–∑–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è `multipart/form-data`. –°–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å FormData.

---

## üõ†Ô∏è –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `/src/api/baseApi.ts`
```typescript
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–±—Ä–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Content-Type
prepareHeaders: (headers, { getState }) => {
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ Authorization
  if (token) {
    headers.set('authorization', `Bearer ${token}`);
  }
  
  // –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Type –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
  // RTK Query —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç FormData –∏ –ø–æ–∑–≤–æ–ª–∏—Ç –±—Ä–∞—É–∑–µ—Ä—É
  // —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ multipart/form-data
  
  return headers;
}
```

### 2. –£–¥–∞–ª–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç
```typescript
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–±—Ä–∞–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∏–º–ø–æ—Ä—Ç config
import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';
import { useDispatch } from 'react-redux';
// import config from '../config'; // ‚Üê –£–¥–∞–ª–µ–Ω–æ
```

### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ FormData —É–∂–µ –±—ã–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π
```typescript
// ‚úÖ –£–ñ–ï –ü–†–ê–í–ò–õ–¨–ù–û –≤ carBrands.api.ts
const formData = new FormData();
formData.append('car_brand[name]', data.name);
formData.append('car_brand[logo]', data.logo);  // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
formData.append('car_brand[is_active]', String(data.is_active));
```

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### üè∑Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ—Ç–∏–ø–æ–≤ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ —á–µ—Ä–µ–∑ API
```bash
‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù:
curl -X PATCH http://localhost:8000/api/v1/car_brands/4 \
  -H "Authorization: Bearer ..." \
  -F "car_brand[name]=BMW Test After Fix" \
  -F "car_brand[logo]=@test-logo.png" \
  -F "car_brand[is_active]=true"

–û–¢–í–ï–¢: {
  "id": 4,
  "name": "BMW Test After Fix",
  "is_active": true,
  "models_count": 5,
  "logo": "http://localhost:8000/rails/active_storage/blobs/redirect/...",
  "created_at": "2025-06-15T12:04:30Z",
  "updated_at": "2025-06-18T13:16:56Z"
}
```

### üñ•Ô∏è –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
‚úÖ –ì–û–¢–û–í –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ:
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: http://localhost:3008/car-brands/4/edit
- –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: file:///home/snisar/mobi_tz/test_car_brand_logo_upload.html
```

---

## üéØ –°–†–ê–í–ù–ï–ù–ò–ï –° –†–ê–ë–û–ß–ò–ú–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø–ú–ò

### üìö –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–ª–æ –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. **–°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ** - —Ä–∞–±–æ—Ç–∞–ª–æ, —Ç–∞–∫ –∫–∞–∫ –ª–æ–≥–∏–∫–∞ —É—Å–ª–æ–≤–Ω–æ–≥–æ FormData –±—ã–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π

### üîç –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–ª–æ:
1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º** - –∏–∑-–∑–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ `Content-Type: application/json`

### üõ†Ô∏è –ö–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ:
```typescript
// –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
headers.set('content-type', 'application/json');  // ‚ùå –õ–æ–º–∞–µ—Ç FormData

// –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
// –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Content-Type –≤–æ–æ–±—â–µ  // ‚úÖ –ë—Ä–∞—É–∑–µ—Ä —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
```

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### üèóÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç FormData –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
1. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type –¥–ª—è FormData:**
   ```
   Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
   ```

2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type (–Ω–∞—à–∞ –æ—à–∏–±–∫–∞):**
   ```
   Content-Type: application/json  // ‚ùå –õ–æ–º–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É FormData
   ```

### üìù RTK Query –∏ FormData:
- RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç FormData –≤ body
- –ï—Å–ª–∏ –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å Content-Type, –±—Ä–∞—É–∑–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ï—Å–ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type, –∑–∞–ø—Ä–æ—Å —Å–ª–æ–º–∞–µ—Ç—Å—è

---

## üéä –°–¢–ê–¢–£–°: –ü–†–û–ë–õ–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê ‚úÖ

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å:
1. **–°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º** ‚úÖ
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º** ‚úÖ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)
3. **–°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ –±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–∞** ‚úÖ
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ –±–µ–∑ –ª–æ–≥–æ—Ç–∏–ø–∞** ‚úÖ
5. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫** ‚úÖ (—Ä–∞–±–æ—Ç–∞–ª–æ –∏ —Ä–∞–Ω—å—à–µ)

### üß™ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:
1. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±—Ä–µ–Ω–¥–æ–≤ –∞–≤—Ç–æ:** http://localhost:3008/car-brands/4/edit
2. **–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:** file:///home/snisar/mobi_tz/test_car_brand_logo_upload.html
3. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫:** http://localhost:3008/partners/1/service-points/11/edit

---

## üìã –ö–û–ú–ê–ù–î–´ –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### üè∑Ô∏è –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–µ–Ω–¥–∞ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º:
```bash
curl -X POST http://localhost:8000/api/v1/car_brands \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "car_brand[name]=New Brand" \
  -F "car_brand[logo]=@test-logo.png" \
  -F "car_brand[is_active]=true"
```

### üè∑Ô∏è –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—Ä–µ–Ω–¥–∞ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º:
```bash
curl -X PATCH http://localhost:8000/api/v1/car_brands/4 \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "car_brand[name]=Updated Brand" \
  -F "car_brand[logo]=@test-logo.png" \
  -F "car_brand[is_active]=true"
```

### üñºÔ∏è –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏:
```bash
curl -X POST http://localhost:8000/api/v1/service_points/11/photos \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "file=@test-logo.png" \
  -F "description=–¢–µ—Å—Ç–æ–≤–∞—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è" \
  -F "is_main=false"
```

---

## üöÄ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞ –ø—É—Ç–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏:** –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ Content-Type –≤ baseApi.ts.

**–ö–ª—é—á–µ–≤–æ–π —É—Ä–æ–∫:** –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å FormData –≤ RTK Query –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ Content-Type –≤—Ä—É—á–Ω—É—é - –ø–æ–∑–≤–æ–ª—å—Ç–µ –±—Ä–∞—É–∑–µ—Ä—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è:** ~1 —á–∞—Å –ø–æ—Å–ª–µ –≤—ã—è–≤–ª–µ–Ω–∏—è –∫–æ—Ä–Ω–µ–≤–æ–π –ø—Ä–∏—á–∏–Ω—ã.

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:** 1 (`src/api/baseApi.ts`)
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~5 —Å—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ/–∏–∑–º–µ–Ω–µ–Ω–æ
- **–§—É–Ω–∫—Ü–∏–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –í—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ RTK Query
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:** –ë—Ä–µ–Ω–¥—ã –∞–≤—Ç–æ, —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –¥—Ä—É–≥–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

---
**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–î–∞—Ç–∞:** 18 –∏—é–Ω—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û
