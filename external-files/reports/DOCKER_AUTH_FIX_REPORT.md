# üîê –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Docker

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –æ—à–∏–±–∫–∏ 401 Unauthorized –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤, —Ö–æ—Ç—è –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏:
```
GET http://service-station.tot.biz.ua/api/v1/clients?page=1&per_page=1
[HTTP/1.1 401 Unauthorized 583ms]

GET http://service-station.tot.biz.ua/api/v1/reviews?page=1&per_page=50
[HTTP/1.1 401 Unauthorized 1097ms]

‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
```

## –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π REACT_APP_API_URL –≤ Docker
- **–ü—Ä–æ–±–ª–µ–º–∞**: –í `docker-compose.yml` –±—ã–ª —É–∫–∞–∑–∞–Ω `http://api:8000` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Docker URL)
- **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `http://service-station.tot.biz.ua:8000` (–≤–Ω–µ—à–Ω–∏–π URL –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–º–µ–Ω–∞ –≤ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- **–ü—Ä–æ–±–ª–µ–º–∞**: `service-station.tot.biz.ua` –Ω–µ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ origins
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–æ–º–µ–Ω–∞ –≤ CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### 3. –ü—Ä–æ–±–ª–µ–º—ã —Å cookies –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: HttpOnly cookies –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ session cookies –≤ Rails

## –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. Frontend (tire-service-master-web)

#### docker-compose.yml
```yaml
# –î–û:
REACT_APP_API_URL: "http://api:8000"
REACT_APP_API_BASE_URL: "http://api:8000/api/v1"

# –ü–û–°–õ–ï:
REACT_APP_API_URL: "http://service-station.tot.biz.ua:8000"  
REACT_APP_API_BASE_URL: "http://service-station.tot.biz.ua:8000/api/v1"
```

#### src/config.ts
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è production –¥–æ–º–µ–Ω–∞
- –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º

### 2. Backend (tire-service-master-api)

#### config/initializers/cors.rb
```ruby
# –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ origins:
'http://service-station.tot.biz.ua:3008',
'https://service-station.tot.biz.ua:3008', 
'http://service-station.tot.biz.ua',
'https://service-station.tot.biz.ua'
```

#### config/application.rb  
```ruby
# –û–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ session cookies:
config.middleware.use ActionDispatch::Session::CookieStore,
                     key: '_tire_service_session',
                     domain: :all,  # –†–∞–∑—Ä–µ—à–∞–µ–º cookies –¥–ª—è –≤—Å–µ—Ö –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤
                     secure: Rails.env.production?,  # Secure —Ç–æ–ª—å–∫–æ –≤ production
                     same_site: :lax  # –ë–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è cross-origin –∑–∞–ø—Ä–æ—Å–æ–≤
```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

### 1. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
docker-compose build --no-cache

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
docker-compose up -d
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```
üîß API Configuration: {
  API_URL: "http://service-station.tot.biz.ua:8000",
  hostname: "service-station.tot.biz.ua",
  REACT_APP_API_URL: "http://service-station.tot.biz.ua:8000"
}
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://service-station.tot.biz.ua:3008`
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É (admin@test.com / admin123)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ API –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (200 OK –≤–º–µ—Å—Ç–æ 401)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ Docker URL
Docker Compose —Å–æ–∑–¥–∞—ë—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å–µ—Ç—å, –≥–¥–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∞–º —Å–µ—Ä–≤–∏—Å–æ–≤ (`api`, `web`). –û–¥–Ω–∞–∫–æ –±—Ä–∞—É–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ –∏ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ URL.

### CORS –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
CORS (Cross-Origin Resource Sharing) –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏. –í—Å–µ –¥–æ–º–µ–Ω—ã, —Å –∫–æ—Ç–æ—Ä—ã—Ö —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã.

### Cookies –∏ –¥–æ–º–µ–Ω—ã
HttpOnly cookies –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è refresh —Ç–æ–∫–µ–Ω–æ–≤. –î–ª—è —Ä–∞–±–æ—Ç—ã –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `domain` –∏ `same_site`.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Nginx proxy
–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã API –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ:
```nginx
location /api/ {
    proxy_pass http://api:8000/api/;
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã
–î–ª—è development –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `/etc/hosts`:
```
127.0.0.1 service-station.local
127.0.0.1 api.service-station.local
```

## –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

- ‚úÖ REACT_APP_API_URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –¥–æ–º–µ–Ω
- ‚úÖ –î–æ–º–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ CORS origins  
- ‚úÖ Session cookies –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è cross-origin
- ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω—ã
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- ‚úÖ API –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200 OK

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ API –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose logs api

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Web –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞  
docker-compose logs web

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
curl -v http://service-station.tot.biz.ua:8000/api/v1/health

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
curl -H "Origin: http://service-station.tot.biz.ua:3008" \
     -H "Access-Control-Request-Method: GET" \
     -H "Access-Control-Request-Headers: X-Requested-With" \
     -X OPTIONS \
     http://service-station.tot.biz.ua:8000/api/v1/clients
```

### –û—Ç–ª–∞–¥–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `Authorization: Bearer ...`)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ cookies (–¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è —Å `credentials: include`)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—à–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –≤ Docker:
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API URL –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è production –¥–æ–º–µ–Ω–∞  
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cookies –¥–ª—è cross-origin –∑–∞–ø—Ä–æ—Å–æ–≤

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

---
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** $(date '+%Y-%m-%d %H:%M:%S')  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é