# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

## üìã –ü—Ä–æ–±–ª–µ–º–∞
–ü–∞—Ä—Ç–Ω–µ—Ä—ã –Ω–µ –º–æ–≥–ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–æ—á–∫–∏ —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/admin/service-points`. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—É—é —Ç–æ—á–∫—É" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: partnerIdNumber —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
```

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è**: –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –±–µ–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–∑–¥–∞–Ω–∏—è
2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º partnerId**: –•—É–∫ `useRoleAccess` –≤–æ–∑–≤—Ä–∞—â–∞–ª `undefined` –¥–ª—è `partnerId` –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: –ù–µ—è—Å–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è `partner_id` - –≤ `user.partner.id` –∏–ª–∏ `user.partner_id`

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ServicePointsPage.tsx
**–§–∞–π–ª**: `tire-service-master-web/src/pages/service-points/ServicePointsPage.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—É—é —Ç–æ—á–∫—É"
```typescript
// –î–û
else {
  // –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –±–µ–∑ partnerId - –≤—ã–±–æ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–∞
  showNotification(t('admin.servicePoints.selectPartnerFirst'), 'warning');
  navigate('/admin/partners');
}

// –ü–û–°–õ–ï  
else {
  // –î–ª—è –∞–¥–º–∏–Ω–æ–≤ - –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –æ–±—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏
  navigate('/admin/service-points/new');
}
```

### 2. ServicePointFormPage.tsx
**–§–∞–π–ª**: `tire-service-master-web/src/pages/service-points/ServicePointFormPage.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `useRoleAccess`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è partnerId –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

```typescript
// –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç
import { useRoleAccess } from '../../hooks/useRoleAccess';

// –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è partnerId
const { partnerId: urlPartnerId, id } = useParams<{ partnerId: string; id: string }>();
const { isPartner, partnerId: userPartnerId } = useRoleAccess();

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä—Ç–Ω–µ—Ä–∞: –∏–∑ URL –∏–ª–∏ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤)
const partnerId = urlPartnerId || (isPartner ? userPartnerId?.toString() : undefined);
```

### 3. useRoleAccess.ts
**–§–∞–π–ª**: `tire-service-master-web/src/hooks/useRoleAccess.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–ª—É—á–µ–Ω–∏—è partnerId
```typescript
// –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
partnerId: user?.partner?.id || (user as any)?.partner_id,

// –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è getCreateServicePointPath
getCreateServicePointPath: () => {
  const partnerId = user?.partner?.id || (user as any)?.partner_id;
  if (userRole === UserRole.PARTNER && partnerId) {
    return `/admin/partners/${partnerId}/service-points/new`;
  }
  return '/admin/service-points/new';
},

// –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è canEditServicePoint  
canEditServicePoint: (servicePoint: { partner_id?: number }) => {
  // ... –ª–æ–≥–∏–∫–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
  const partnerId = user?.partner?.id || (user as any)?.partner_id;
  if (userRole === UserRole.PARTNER && partnerId) {
    return servicePoint.partner_id === partnerId;
  }
  return false;
}
```

## üß™ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
**–§–∞–π–ª**: `tire-service-master-web/external-files/testing/test_partner_user_data.html`

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π HTML —Ç–µ—Å—Ç –¥–ª—è:
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–∞–∫ –ø–∞—Ä—Ç–Ω–µ—Ä
- –ü–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ API
- –ê–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ partnerId

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
1. –ü–∞—Ä—Ç–Ω–µ—Ä—ã –º–æ–≥—É—Ç –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—É—é —Ç–æ—á–∫—É" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/admin/service-points`
2. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–∑–¥–∞–Ω–∏—è —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º partnerId
3. –§–æ—Ä–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å partnerId –ø–∞—Ä—Ç–Ω–µ—Ä–∞
4. –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

## üîÑ –°—Ç–∞—Ç—É—Å
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ –ò–º–ø–æ—Ä—Ç useRoleAccess –¥–æ–±–∞–≤–ª–µ–Ω  
- ‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏ –∫ partnerId —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞
- üîÑ **–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–π —Ç–æ—á–∫–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –£–±—Ä–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
4. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏

---
*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–°—Ç–∞—Ç—É—Å: –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è* 