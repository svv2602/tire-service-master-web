# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google OAuth –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Tire Service

## üìã –û–±–∑–æ—Ä

Google OAuth –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/login` –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—Ö–æ–¥–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑ —Å–≤–æ–π Google –∞–∫–∫–∞—É–Ω—Ç.

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Console

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ Google Cloud Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ **Google+ API** –∏ **Google Identity Services**

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth 2.0

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **APIs & Services** ‚Üí **Credentials**
2. –ù–∞–∂–º–∏—Ç–µ **Create Credentials** ‚Üí **OAuth 2.0 Client IDs**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: **Web application**
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
   - **Authorized JavaScript origins**:
     - `http://localhost:3008` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
     - `https://yourdomain.com` (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
   - **Authorized redirect URIs**:
     - `http://localhost:3008/login` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
     - `https://yourdomain.com/login` (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Client ID

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è OAuth –∫–ª–∏–µ–Ω—Ç–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- **Client ID** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
- **Client Secret** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –±—ç–∫–µ–Ω–¥–µ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Frontend

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ `tire-service-master-web/`:

```env
# Google OAuth Configuration
REACT_APP_GOOGLE_CLIENT_ID=–≤–∞—à-google-client-id-–∑–¥–µ—Å—å
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

Google OAuth –∫–Ω–æ–ø–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/login` –µ—Å–ª–∏:
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `REACT_APP_GOOGLE_CLIENT_ID` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- Client ID –Ω–µ —Ä–∞–≤–µ–Ω `your-google-client-id`

–ï—Å–ª–∏ Client ID –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–≤–∏–¥—è—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
> "Google OAuth –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Ö–æ–¥ –ø–æ email –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É."

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Backend

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

Backend —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Google OAuth —á–µ—Ä–µ–∑ endpoint:
```
POST /api/v1/clients/social_auth
```

### 2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

```json
{
  "provider": "google",
  "token": "google-oauth-token",
  "provider_user_id": "google-user-id",
  "email": "user@example.com",
  "first_name": "–ò–º—è",
  "last_name": "–§–∞–º–∏–ª–∏—è"
}
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Google —Ç–æ–∫–µ–Ω–∞:

```ruby
# –í ClientsController#social_auth
def verify_google_token(token)
  require 'net/http'
  require 'json'
  
  uri = URI("https://oauth2.googleapis.com/tokeninfo?id_token=#{token}")
  response = Net::HTTP.get_response(uri)
  
  if response.code == '200'
    JSON.parse(response.body)
  else
    nil
  end
end
```

## üé® UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### GoogleLoginButton

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤: `src/components/auth/GoogleLoginButton.tsx`

**–°–≤–æ–π—Å—Ç–≤–∞:**
- `onSuccess?: () => void` - callback –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `onError?: (error: string) => void` - callback –ø—Ä–∏ –æ—à–∏–±–∫–µ
- `variant?: 'contained' | 'outlined'` - —Å—Ç–∏–ª—å –∫–Ω–æ–ø–∫–∏
- `fullWidth?: boolean` - —Ä–∞—Å—Ç—è–Ω—É—Ç—å –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É
- `disabled?: boolean` - –æ—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```tsx
<GoogleLoginButton 
  onSuccess={() => navigate('/client/profile')}
  onError={(error) => setError(error)}
  variant="outlined"
  fullWidth
/>
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

- –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ Google SDK
- –ü—Ä–æ–±–ª–µ–º—ã —Å Client ID
- –û—Ç–≤–µ—Ç—ã –æ—Ç API

### 2. –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **"The given client ID is not found"**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Client ID
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–æ–º–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ Authorized origins

2. **"Provider's accounts list is empty"**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Google
   - –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö Google –∞–∫–∫–∞—É–Ω—Ç–æ–≤

3. **403 Forbidden**
   - –î–æ–º–µ–Ω –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ
   - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CORS

## üì± –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

Google OAuth –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–æ–±–∏–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã, –Ω–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö redirect URI
- –û–±—Ä–∞–±–æ—Ç–∫–∞ popup –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤
- Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Client ID** - –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω–æ
2. **Client Secret** - —Ç–æ–ª—å–∫–æ –¥–ª—è –±—ç–∫–µ–Ω–¥–∞, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
3. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è Google OAuth –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- Frontend: –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
- Backend: Rails –ª–æ–≥–∏
- –£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

- [x] Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–æ—Ç–æ–≤
- [x] Backend API –≥–æ—Ç–æ–≤  
- [x] –ü–µ—Ä–µ–≤–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã (RU/UK)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Console
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ 